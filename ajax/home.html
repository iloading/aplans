<script>
    function mostrarHome() {
         
        $.ajax({ // ajax call starts
            url: 'scripts/sc_home.php',
            dataType: 'json', // Choosing a JSON datatype
            
        })
        
        .done(function (data) {
            $('#conteudoPagina').html(''); //limpa o conteúdo da tabela
           console.log(data);

           var eventosCriados = '';
           var indicators = '';
           var upcoming = '';
           var cardsAmigos ='';
           var listaAmigos= '';
           var listaPlanos = '';
           var setaDireita = '';
           var setaEsquerda = '';
           var adicionarNovoEvento = '';
           var adicionarAmigos ='';
           var modalAmigos ='';
           var start_div ='';
           var end_div ='';
           

            console.log(data.created[0]);
            if (data.created[0] != 'vazio'){
                for (let i = 0; i < data.created.length; i++) {
                    //Se for o primeiro tem de estar active
                    if (i == 0) {
                        eventosCriados += '<div id="' + data.created[i]["id_evento"] + '" class="carousel-item active btn-evento"> <div class="events container-fluid"> <div class="row"> <p class="col-12">' + data.created[i]["nomeEventoCriado"] + '</p> <p class="col-12 data_evento">' + data.created[i]["diaEventoCriado"] + '</p> <p class="col-12 data_evento">' + data.created[i]["horaEventoCriado"] + '</p></div> </div> </div>';
                        indicators += '<li class="active" data-target="#carouselExampleIndicators1" data-slide-to="'+i+'"></li>'
                        setaDireita += '<a class="carousel-control-next" href="#carouselExampleIndicators1" role="button" data-slide="next" style="right: -2vw"> <span class="carousel-control-next-icon" aria-hidden="true"></span> <span class="sr-only">Next</span> </a> '
                        setaEsquerda += '<a class="carousel-control-prev" href="#carouselExampleIndicators1" role="button" data-slide="prev" style="left: -2vw"> <span class="carousel-control-prev-icon" aria-hidden="true"></span> <span class="sr-only">Previous</span> </a>'
                        adicionarNovoEvento += '<div class="col-3"> <div class="add-event">+</div> </div>'
                    }else{
                        eventosCriados += '<div id="' + data.created[i]["id_evento"] + '" class="carousel-item btn-evento"> <div class="events container-fluid"> <div class="row"> <p class="col-12">' + data.created[i]["nomeEventoCriado"] + '</p> <p class="col-12">' + data.created[i]["dataEventoCriado"] + '</p> </div> </div> </div>';
                        indicators += '<li data-target="#carouselExampleIndicators1" data-slide-to="' + i + '"></li>';
                    }
                        
                }
            }else{
                adicionarNovoEvento += '<div class="col-10 semEvento"> <div class="add-event" style="margin-top: 7%;margin-bottom:7%;">+</div><div><p style="margin:0;font-weight: 600;text-align: center;">Não tens eventos criados</p><p style="font-weight: 600;text-align: center;">Clica aqui para criar o teu primeiro evento!</p><div></div>'
            }
            

            for (let i = 0; i < data.upcoming.length; i++) {
                if (i < 8) {
                    upcoming += ' <div id="' + data.upcoming[i]["id_evento"] + '" class="col-3 text-center btn-evento"> <div class="add-event"><img src="images'+ data.upcoming[i]["icon_tipo"] +'" class="w-50"></div> <p>'+ data.upcoming[i]["nome_evento"]+'</p> </div>';
                }

                 listaPlanos += '';
              
            }
            if (data.amigos[0] != 'vazio'){

                  adicionarAmigos += '<div class="col-3"> <div class="add-event">+</div> </div>';
                  modalAmigos += '<a data-toggle="modal" data-target="#mostarAmigos">Ver todos</a>';

                  start_div += '<div class="col-9 row p-0">';
                  end_div +='</div>';
                  



                for (let i = 0; i < data.amigos.length; i++) {

                    if(i<3){
                        cardsAmigos += '<div class="events container-fluid p-0" style="height: 16vh; max-width:30%;"> <div class="row d-flex justify-content-center"><div><img class="avatar-circular-amigos" src="images' + data.amigos[i]["imagem_amigo"] +'" alt="user"></div><p class="col-12 pt-2">' + data.amigos[i]["nomesAmigos"] + '</p></div> </div> ';

                    }

                    
                    listaAmigos +=' <div class="container"> <div class="row"> <div class="col-3 d-flex justify-content-center p-0"> <div class="pb-2 pt-2"> <img class="avatar-circular" src="images' + data.amigos[i]["imagem_amigo"] +'" alt="user"> </div> </div> <div class="col-4 p-0 d-flex align-items-center"> <p class="m-0"><a href="#" class="text-dark">' + data.amigos[i]["nomesAmigos"] + '</a></p> </div> <div class="col-5 d-flex align-items-center justify-content-end"><img src="images/profile/more.png" class="w-25"></div> </div> </div><hr>';

                    //listaAmigos += '<div class="row mb-4 pt-3 pb-3" > <div class="pl-0 pt-2 pb-4 pr-0 ml-5 d-flex align-items-center col-2"> <div class=" avatar-circular"><img src="images' + data.amigos[i][" imagem_amigo"] +'"> </div> </div> <div class="pl-3 d-flex align-items-center col-9"> <div class="row"> <div class="col-12 pr-0"> <span class="display-4 font-weight-normal">' + data.amigos[i]["nomesAmigos"] + '</span></div> <h1 class="col-12 display-6 font-weight-light" style="margin-bottom: 8px;">Popcorn Dealer</h1> </div> </div> </div>';
                    
                }
            }else{
                cardsAmigos +='<div class="col-10 semEvento container"> <div class="row"><div class="col-2"><div class="add-event" style="margin-top: 50%;margin-bottom:50%;">+</div></div><div class="col-10 d-flex flex-column justify-content-center align-items-center"><p class="d-flex align-items-center" style="font-weight: 600;margin:0;">És novo na aplicação?</p><p class="d-flex align-items-center" style="font-weight: 600;margin:0;">Adiciona novos amigos!</p></div></div> </div>';
            }
          
            
        

            
            var home = '<main id="main" class="alturaMainLogin text-white bg-azul-aplans d-flex flex-column align-items-start"> <div class="container p-3"> <section class="row d-flex" style="align-items: center;"> <div class="col-6 text-left" style="height: 100%;"> <div class="div-logo"><a href="index.php"><img class="mw-100" src="assets/aplans.png" alt="logotipo"></a></div> </div><div class="col-6 text-right dropdown" style="height:100%"> <div class="avatar-circular"><img  onclick="menu_avatar()" class="mw-100 dropbtn" src="assets/avatar.png" alt="avatar"></div> <div id="myDropdown" class="dropdown-content"><div class="d-flex justify-content-between"><div><img src="images/others/utilizador.png" style="width:20px;"></div><div><p class="m-0">Perfil</p></div></div><div class="d-flex justify-content-between"><div><img src="images/others/settings.png" style="width:20px;"></div><div><p class="m-0">Admin</p></div></div><div class="d-flex justify-content-between" style="background-color: rgba(240,52,52,0.5);/* background-color: white; */"><div><img src="images/others/sair.png" style="width:20px;"></div><div><p class="m-0 font-weight-bold">Sair</p></div></div></div> </div> </section> </div> <div class="container p-3"> <section class="row pl-3"> <p class="index-titulos">Created Plans</p> </section> <section class="row justify-content-center" style="align-items: center;"> '+adicionarNovoEvento+' <div id="carouselExampleIndicators1" class="carousel slide col-8 m-auto" data-interval="false"> <ol class="carousel-indicators" style="bottom: -6vh;">'+indicators+'</ol> <div class="carousel-inner"> '+eventosCriados+' </div> '+setaEsquerda+' '+setaDireita+'</div> </section> </div> <div class="container p-3"><section class="row pl-3"> <p class="index-titulos col-6 p-0">Planos Futuros</p> <p class="index-titulos text-right col-6 " style="font-size:small;"><a data-toggle="modal" data-target="#mostarPlanos">Ver todos</a></p> </section><section class="row">'+upcoming+'</section> </div> <div class="container p-3"> <section class="row pl-3"> <p class="index-titulos col-6 p-0">Meus Amigos</p> <p class="index-titulos text-right col-6 " style="font-size:small;">'+modalAmigos+'</p> </section> <section class="row" style="align-items: center;"> '+adicionarAmigos+'' + start_div +''+cardsAmigos+'' + end_div +' </section> </div></main>'

           
            $('#conteudoPagina').append(home);
            $('#amigosBody').append(listaAmigos);
            $('#upcomingPlans').append(listaPlanos);

        })
    }
        /* Quando o utilizador clica no seu avatar */
          function menu_avatar() {
            document.getElementById("myDropdown").classList.toggle("show");
          }

          // O dropdown fecha se o utilizador clicar fora dele 
          window.onclick = function(event) {
            if (!event.target.matches('.dropbtn')) {
              var dropdowns = document.getElementsByClassName("dropdown-content");
              var i;
              for (i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                  openDropdown.classList.remove('show');
                }
              }
            }
          }
</script>






<!------------------------------- MODAIS -------------------------------->


<!-- Modal -->
<div class="modal fade" id="mostarAmigos" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Amigos</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div id="amigosBody"class="modal-body">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>



<!-- Modal -->
<div class="modal fade" id="mostarPlanos" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Planos</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div id="upcomingPlans" class="modal-body">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>